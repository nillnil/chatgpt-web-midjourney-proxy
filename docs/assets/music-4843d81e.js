var A=Object.defineProperty;var Y=(l,t,e)=>t in l?A(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var F=(l,t,e)=>(Y(l,typeof t!="symbol"?t+"":t,e),e);import{b2 as M,m as k,O as p,a$ as z,b3 as G,d as N,r as x,l as H,a2 as J,$ as Q,o as v,c as g,b as u,ab as h,R as r,b4 as R,a as n,N as w,a6 as m,a5 as $,aV as X,ah as b,b5 as q,Q as D,aj as W,a1 as S,ac as Z,a3 as U,a4 as T,X as O,aa as ee,a8 as te,a9 as E,b6 as V}from"./index-2c2818f8.js";import{N as P,a as ae}from"./Switch-ece9035a.js";class B{constructor(){F(this,"localKey","suno-store")}save(t){if(!t.id)throw"id must";let e=this.getObjs(),s=e.findIndex(y=>y.id==t.id);return s>-1?e[s]=t:e.push(t),M.set(this.localKey,e),this}findIndex(t){return this.getObjs().findIndex(e=>e.id==t)}getObjs(){const t=M.get(this.localKey);return t||[]}}const se=l=>l.indexOf("http")==0?l:z.myData.SUNO_SERVER?`${z.myData.SUNO_SERVER}${l}`:`/sunoapi${l}`;function le(){let l={};if(p.myData.vtoken){const e={"x-vtoken":p.myData.vtoken,"x-ctoken":p.myData.ctoken};l={...l,...e}}if(!z.myData.SUNO_KEY){const e=G();if(e.token){const s={"x-ptoken":e.token};return l={...l,...s},l}return l}const t={Authorization:"Bearer "+z.myData.SUNO_KEY};return l={...l,...t},l}function K(l){return new Promise(t=>setTimeout(t,l))}const oe=async l=>{for(let t=0;t<50;t++){let e=await j(`/lyrics/${l}`);k("ddd",e);let s=t+1;if(s>20&&(s=20),e.status=="complete")return e;await K(s*1e3)}return null};function I(){const l=["acoustic","aggressive","anthemic","atmospheric","bouncy","chill","dark","dreamy","electronic","emotional","epic","experimental","futuristic","groovy","heartfelt","infectious","melodic","mellow","powerful","psychedelic","romantic","smooth","syncopated","uplifting",""],t=["afrobeat","anime","ballad","bedroom pop","bluegrass","blues","classical","country","cumbia","dance","dancepop","delta blues","electropop","disco","dream pop","drum and bass","edm","emo","folk","funk","future bass","gospel","grunge","grime","hip hop","house","indie","j-pop","jazz","k-pop","kids music","metal","new jack swing","new wave","opera","pop","punk","raga","rap","reggae","reggaeton","rock","rumba","salsa","samba","sertanejo","soul","synthpop","swing","synthwave","techno","trap","uk garage"],e=l[Math.floor(Math.random()*l.length)],s=t[Math.floor(Math.random()*t.length)];return e+" "+s}const L=async l=>{const t=new B;if(l.length<=0)return;let e=await j("/feed/"+l.join(","));k("FeedTask",e),e.forEach(s=>{t.save(s),s.status=="complete"&&(l=l.filter(y=>y!=s.id))}),p.setMyData({act:"FeedTask"}),await K(5*1e3),L(l)},j=(l,t,e)=>{k("sunoFetch",l);let s={"Content-Type":"application/json"};return e&&e.headers&&(s=e.headers),s={...s,...le()},new Promise((y,d)=>{let f={method:"GET"};f.headers=s,e!=null&&e.upFile?(f.method="POST",f.body=t):t&&(f.body=JSON.stringify(t),f.method="POST"),fetch(se(l),f).then(async _=>{var i;if(!_.ok){let a="发生错误: "+_.status;try{let o=await _.json();a="("+_.status+")发生错误: "+(((i=o==null?void 0:o.error)==null?void 0:i.message)??"")}catch{}throw p.myData.ms&&p.myData.ms.error(a),new Error(a)}_.json().then(a=>y(a)).catch(a=>{p.myData.ms&&p.myData.ms.error("发生错误"+a),d(a)})}).catch(_=>{_.name==="TypeError"&&_.message==="Failed to fetch"?p.myData.ms&&p.myData.ms.error("跨域|CORS error"):p.myData.ms&&p.myData.ms.error("发生错误:"+_),k("e",_.stat),d(_)})})},ne={class:"p-2"},ie={class:"pt-1"},re={class:"pt-4 flex justify-between"},ue={class:"pt-1"},de={class:"pt-1"},ce={class:"pt-4"},pe={class:"pt-4 flex justify-between"},me={class:"pt-1"},ve={class:"pt-4"},fe={class:"flex justify-between items-start"},ye=N({__name:"mcInput",setup(l){const t=x({type:"custom",isLoading:!1}),e=x({gpt_description_prompt:"",make_instrumental:!1,mv:"chirp-v3-0",prompt:""}),s=x({prompt:"",mv:"chirp-v3-0",title:"",tags:"",continue_at:120,continue_clip_id:""}),y=H(()=>t.value.isLoading?!1:t.value.type=="custom"?s.value.tags&&s.value.title:t.value.type=="description"?(k("des: ",e.value.gpt_description_prompt,e.value.make_instrumental),s.value.title&&(e.value.gpt_description_prompt||e.value.make_instrumental)):!0),d=J();Q(()=>{p.setMyData({ms:d})});const f=()=>{let i=s.value.prompt||s.value.title;if(!i){d.error(U("suno.inputly"));return}if(t.value.isLoading){d.info(U("suno.doingly"));return}t.value.isLoading=!0,d.info(U("suno.doingly2")),j("/generate/lyrics/",{prompt:i}).then(async a=>{k("lyrics",a);let o=await oe(a.id);k("lyrics rz =>",o),o!=null&&(s.value.prompt=o.text,s.value.title=o.title),t.value.isLoading=!1}).catch(()=>t.value.isLoading=!1),s.value.tags||(s.value.tags=I())},_=async()=>{t.value.isLoading=!1;let i=["0d435185-d440-42c8-982a-50205e1cf17d","43e095ba-5f08-4920-bb3d-89dd0defe0b7"];if(i=["d359a0aa-adf1-4298-9074-005573d7cc84","12e3d62f-8fcc-497b-8365-194657582519"],t.value.type=="custom"){e.value.make_instrumental&&(s.value.prompt="");let a=await j("/generate",s.value);t.value.isLoading=!1,i=a.clips.map(o=>o.id),k("ids ",i)}else{e.value.prompt=s.value.title;let a=await j("/generate/description-mode",e.value);t.value.isLoading=!1,i=a.clips.map(o=>o.id)}L(i)};return(i,a)=>(v(),g("div",ne,[u(r(q),{type:"segment",animated:"",value:t.value.type,"onUpdate:value":a[8]||(a[8]=o=>t.value.type=o)},{default:h(()=>[u(r(R),{name:"description",tab:i.$t("suno.description")},{default:h(()=>[n("div",ie,[u(r(w),{placeholder:i.$t("suno.titlepls"),value:s.value.title,"onUpdate:value":a[0]||(a[0]=o=>s.value.title=o)},{prefix:h(()=>[n("span",null,m(i.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),n("div",re,[n("div",null,m(i.$t("suno.desc"))+":",1),n("div",null,[u(r(P),{value:e.value.make_instrumental,"onUpdate:value":a[1]||(a[1]=o=>e.value.make_instrumental=o),size:"small"},{checked:h(()=>[$(m(i.$t("suno.noneedly")),1)]),unchecked:h(()=>[$(m(i.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),n("div",ue,[u(r(w),{value:e.value.gpt_description_prompt,"onUpdate:value":a[2]||(a[2]=o=>e.value.gpt_description_prompt=o),disabled:e.value.make_instrumental,placeholder:i.$t("suno.descpls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])])]),_:1},8,["tab"]),u(r(R),{name:"custom",tab:i.$t("suno.custom")},{default:h(()=>[n("div",de,[u(r(w),{placeholder:i.$t("suno.titlepls"),value:s.value.title,"onUpdate:value":a[3]||(a[3]=o=>s.value.title=o)},{prefix:h(()=>[n("span",null,m(i.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),n("div",ce,[u(r(w),{placeholder:i.$t("suno.stylepls"),value:s.value.tags,"onUpdate:value":a[5]||(a[5]=o=>s.value.tags=o)},{prefix:h(()=>[n("span",null,m(i.$t("suno.style"))+"：",1)]),suffix:h(()=>[u(r(X),{placement:"right",trigger:"hover"},{trigger:h(()=>[n("div",{class:"cursor-pointer",onClick:a[4]||(a[4]=o=>s.value.tags=r(I)())},[u(r(b),{icon:"fa:random",class:"w-4 h-4"})])]),default:h(()=>[n("div",null,m(i.$t("suno.rank")),1)]),_:1})]),_:1},8,["placeholder","value"])]),n("div",pe,[n("div",null,m(i.$t("suno.ly"))+" :",1),n("div",null,[u(r(P),{value:e.value.make_instrumental,"onUpdate:value":a[6]||(a[6]=o=>e.value.make_instrumental=o),size:"small"},{checked:h(()=>[$(m(i.$t("suno.noneedly")),1)]),unchecked:h(()=>[$(m(i.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),n("div",me,[u(r(w),{value:s.value.prompt,"onUpdate:value":a[7]||(a[7]=o=>s.value.prompt=o),disabled:e.value.make_instrumental,placeholder:i.$t("suno.lypls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])])]),_:1},8,["tab"])]),_:1},8,["value"]),n("div",ve,[n("div",fe,[n("div",null,[t.value.type=="custom"?(v(),D(r(W),{key:0,type:"success",size:"small",round:""},{default:h(()=>[n("span",{class:"cursor-pointer",onClick:a[9]||(a[9]=o=>f())},m(i.$t("suno.generately")),1)]),_:1})):S("",!0)]),u(r(Z),{type:"primary",disabled:!r(y),onClick:a[10]||(a[10]=o=>_())},{default:h(()=>[u(r(b),{icon:"ri:music-fill"}),$(" "+m(i.$t("suno.generate")),1)]),_:1},8,["disabled"])])])]))}}),he={class:"sss",style:{"--n-rail-height":"2px"}},_e=N({__name:"playui",emits:["update"],setup(l,{emit:t}){const e=x({v:10,max:0,status:"",idDrop:!1}),s=y=>{p.setMyData({act:"playUpdate",actData:{v:y}})};return T(()=>p.myData.act2,y=>{if(y=="playStatus"){if(e.value.idDrop)return;let d=p.myData.actData;k("playStatus",d),d&&d.d&&d.d.duration&&(e.value.max=d.d.duration,e.value.v=d.d.currentTime),d&&(e.value.status=d.a),t("update",e.value)}}),T(()=>p.myData.act,y=>{if(y=="playStatus"){let d=p.myData.actData;d&&(e.value.status=d.a),t("update",e.value)}}),(y,d)=>(v(),g("div",he,[e.value.max?(v(),D(r(ae),{key:0,"on-dragend":()=>e.value.idDrop=!1,"on-dragstart":()=>e.value.idDrop=!0,class:"w-full",value:e.value.v,"onUpdate:value":d[0]||(d[0]=f=>e.value.v=f),step:1,max:e.value.max,"on-update:value":s,"format-tooltip":f=>f.toFixed(1)+"s"},null,8,["on-dragend","on-dragstart","value","max","format-tooltip"])):S("",!0)]))}});const ge={key:0},ke=["onClick"],be={class:"w-full h-full justify-center items-center flex"},xe={key:0,class:"absolute top-0 right-0 w-full h-full flex justify-center items-center"},we={class:"absolute top-0 right-0 w-full h-full justify-center items-center flex"},$e={class:"flex-1 pl-2"},De=["onClick"],Se={class:"opacity-80"},je=["onClick"],Ne=["onClick"],Ce={class:"text-right text-[14px] flex justify-end items-center space-x-2"},ze={key:0,class:"text-[10px] flex items-center border-[1px] border-gray-500/30 px-0.5 list-none rounded-md"},Te=["href"],Ue={key:1,class:"w-full h-full flex justify-center items-center"},Oe=N({__name:"mcList",setup(l){const t=x([]),e=new B,s=x({playid:""}),y=()=>{let a=e.getObjs();t.value=a.reverse()},d=a=>a.id==s.value.playid?["bg-gray-200","dark:bg-black"]:[],f=a=>{s.value.playid=a.id,p.setMyData({act:"goPlay",actData:a}),a.status!="complete"&&L([a.id])},_=x({v:10,max:0,status:"",idDrop:!1});T(()=>p.myData.act,a=>{if(a=="FeedTask"&&y(),a=="playEned"){let o=t.value.findIndex(c=>c.id==s.value.playid);o++,k("playEned,",o,t.value.length),o<t.value.length&&setTimeout(()=>f(t.value[o]),1e3)}});const i=a=>{_.value=a};return y(),(a,o)=>t.value.length>0?(v(),g("div",ge,[(v(!0),g(O,null,ee(t.value,c=>(v(),g("div",{class:te([d(c),"flex relative justify-between items-start p-2 hover:dark:bg-black hover:bg-gray-200 border-b-[1px] border-gray-500/10"])},[s.value.playid==c.id?(v(),D(_e,{key:0,onUpdate:i,class:"absolute top-[-4px] left-0 w-full z-10"})):S("",!0),n("div",{class:"w-[60px] h-[60px] relative cursor-pointer",onClick:C=>f(c)},[c.status=="complete"?(v(),g(O,{key:0},[u(r(E),{lazy:"",width:"100",src:c.image_url,"preview-disabled":""},{placeholder:h(()=>[n("div",be,[u(r(b),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])]),_:2},1032,["src"]),s.value.playid==c.id?(v(),g("div",xe,[_.value.status=="pause"?(v(),D(r(b),{key:0,icon:"mdi:pause-circle-outline",class:"text-[40px] text-[#fff]"})):(v(),D(r(b),{key:1,icon:"mdi:play-circle-outline",class:"text-[40px] text-[#fff]"}))])):S("",!0)],64)):(v(),g(O,{key:1},[u(r(E),{lazy:"",width:"100",src:c.image_url,"preview-disabled":""},null,8,["src"]),n("div",we,[u(r(b),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])],64))],8,ke),n("div",$e,[n("div",{class:"flex justify-between line-clamp-1 w-full cursor-pointer",onClick:C=>f(c)},[n("h3",null,m(c.title),1),n("div",Se,m(c.metadata.tags),1)],8,De),c.metadata&&c.metadata.prompt?(v(),g("div",{key:0,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:C=>f(c)},m(c.metadata.prompt),9,je)):(v(),g("div",{key:1,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:C=>f(c)},m(a.$t("suno.noly")),9,Ne)),n("div",Ce,[c.metadata&&c.metadata.duration?(v(),g("div",ze,m(c.metadata.duration.toFixed(1))+"s",1)):S("",!0),u(r(b),{icon:"mdi:play-circle-outline",class:"cursor-pointer",onClick:C=>f(c)},null,8,["onClick"]),n("a",{href:c.audio_url,download:"",target:"_blank"},[u(r(b),{icon:"mdi:download",class:"cursor-pointer"})],8,Te)])])],2))),256))])):(v(),g("div",Ue,[u(r(V),{description:a.$t("suno.nodata")},null,8,["description"])]))}}),Ee={key:0},Le={class:"w-full relative h-[300px]"},Fe={class:"w-full h-full justify-center items-center flex"},Me={class:"absolute bottom-0 right-0 p-2 text-white text-right"},Re={class:"text-xl"},Pe={class:""},Ie={class:"text-wrap p-2"},Ve={key:1,class:"flex w-full h-full justify-center items-center"},Be=N({__name:"mcplayer",setup(l){const t=x();return T(()=>p.myData.act,e=>{if(e=="goPlay"){let s=p.myData.actData;t.value=s}}),(e,s)=>t.value?(v(),g("div",Ee,[n("div",Le,[u(r(E),{src:t.value.image_large_url,class:"w-full h-full"},{placeholder:h(()=>[n("div",Fe,[u(r(b),{icon:"line-md:downloading-loop",class:"text-[60px] text-green-300"})])]),_:1},8,["src"]),n("div",Me,[n("h2",Re,m(t.value.title),1),n("div",Pe,m(e.$t("suno.style"))+"："+m(t.value.metadata.tags),1)])]),n("pre",Ie,m(t.value.metadata.prompt),1)])):(v(),g("div",Ve,[u(r(V),{description:e.$t("suno.emputy")},null,8,["description"])]))}}),Ke={class:"flex w-full h-full"},Ae={class:"w-[300px] h-full overflow-y-auto"},Ye={class:"flex-1 h-full bg-[#fafbfc] pt-2 dark:bg-[#18181c] overflow-y-auto"},Ge={class:"w-[300px] h-full overflow-y-auto"},Xe=N({__name:"music",setup(l){return(t,e)=>(v(),g("div",Ke,[n("div",Ae,[u(ye)]),n("div",Ye,[u(Oe)]),n("div",Ge,[u(Be)])]))}});export{Xe as default};
